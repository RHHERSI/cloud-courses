# Accessing DynamoDB by Mark Richman

## Console configuration

* Table Names
* Primary Key (Partition Key can only be of number, string or binary)
* Provisioned capacity mode
    * Provisioned
    * On-demand 
* Secondary indexes
    * Local (Same Partition Key but different Sort Key) **MUST BE CREATED ON CREATION TIME**
    * Global 
* Provisioned capacity
    * Define RCU and WCU
* Scaling
    * Max RCU and MCU 
* Encryption
    * Default or KMS

**Tables are specified per Region but Global Tables can be set up for multiregion replication**

## AWS CLI

Creating own access keys

Go to IAM
Create Access Key
* Access Key ID
* Secret Access Key

```sh
aws configure
# insert access key id
# insert secret access key
aws sts get-caller-identity
# returns the account
aws dynamodb help
# get help
aws dynamodb create-table help
# get create-table help
```

### Create DynamoDB Table on Shell

```sh
aws dynamodb create-table \
--table-name Music \
--key-schema AttributeName=Artist,KeyType=HASH \
             AttributeName=SongTitle,KeyType=RANGE \
--attribute-definitions \
             AttributeName=Artist,AttributeType=S \
             AttributeName=SongTitle,AttributeType=S \
--provisioned-throughput \
             ReadCapacityUnits=5,WriteCapacityUnits=5

aws dynamodb describe-table --table-name Music
# Definition of table
```

### Put Item

```sh
aws dynamodb put-item \
    --table-name Music \
    --item '{
        "Artist": { "S": "Dream" },
        "AlbumTitle": { "S": "Images and Words" },
        "SongTitle": { "S": "Undler a Glass Moon" },
    }'

aws dynamodb scan --table-name Music
# Scan for all data
```

## SDK Options

[![Interaction between app and aws sdk](https://mermaid.ink/img/eyJjb2RlIjoic3RhdGVEaWFncmFtXG4gICAgWypdIC0tPiBBcHBcbiAgICBBcHAgLS0-IEFXU1NESzogQVBJIExldmVsIFJlcXVlc3RcbiAgICBBV1NTREsgLS0-IEFwcDogQVBJIExldmVsIFJlc3BvbnNlXG4gICAgQVdTU0RLIC0tPiBEREJMb3dMZXZlbDogTG93IExldmVsIFJlcXVlc3RcbiAgICBEREJMb3dMZXZlbCAtLT4gQVdTU0RLOiBMb3cgTGV2ZWwgUmVzcG9uc2VcbiAgICBEREJMb3dMZXZlbCAtLT4gRHluYW1vREI6IEhUVFBTIFJlcXVlc3RcbiAgICBEeW5hbW9EQiAtLT4gRERCTG93TGV2ZWw6IEhUVFBTIFJlc3BvbnNlXG4gICAgRHluYW1vREIiLCJtZXJtYWlkIjp7InRoZW1lIjoiZGFyayIsInRoZW1lVmFyaWFibGVzIjp7ImJhY2tncm91bmQiOiIjMzMzIiwicHJpbWFyeUNvbG9yIjoiIzFmMjAyMCIsInNlY29uZGFyeUNvbG9yIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwidGVydGlhcnlDb2xvciI6ImhzbCgyMCwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwicHJpbWFyeUJvcmRlckNvbG9yIjoiaHNsKDE4MCwgMCUsIDIuMzUyOTQxMTc2NSUpIiwic2Vjb25kYXJ5Qm9yZGVyQ29sb3IiOiJoc2woMTgwLCAwJSwgMTguMzUyOTQxMTc2NSUpIiwidGVydGlhcnlCb3JkZXJDb2xvciI6ImhzbCgyMCwgMCUsIDIuMzUyOTQxMTc2NSUpIiwicHJpbWFyeVRleHRDb2xvciI6IiNlMGRmZGYiLCJzZWNvbmRhcnlUZXh0Q29sb3IiOiJyZ2IoMTgzLjg0NzYxOTA0NzUsIDE4MS41NTIzODA5NTIzLCAxODEuNTUyMzgwOTUyMykiLCJ0ZXJ0aWFyeVRleHRDb2xvciI6InJnYigyMjIuOTk5OTk5OTk5OSwgMjIzLjY2NjY2NjY2NjYsIDIyMy45OTk5OTk5OTk5KSIsImxpbmVDb2xvciI6ImxpZ2h0Z3JleSIsInRleHRDb2xvciI6IiNjY2MiLCJtYWluQmtnIjoiIzFmMjAyMCIsInNlY29uZEJrZyI6ImhzbCgxODAsIDEuNTg3MzAxNTg3MyUsIDI4LjM1Mjk0MTE3NjUlKSIsIm1haW5Db250cmFzdENvbG9yIjoibGlnaHRncmV5IiwiZGFya1RleHRDb2xvciI6ImhzbCgyOC41NzE0Mjg1NzE0LCAxNy4zNTUzNzE5MDA4JSwgODYuMjc0NTA5ODAzOSUpIiwiYm9yZGVyMSI6IiM4MUIxREIiLCJib3JkZXIyIjoicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KSIsImFycm93aGVhZENvbG9yIjoibGlnaHRncmV5IiwiZm9udEZhbWlseSI6IlwidHJlYnVjaGV0IG1zXCIsIHZlcmRhbmEsIGFyaWFsIiwiZm9udFNpemUiOiIxNnB4IiwibGFiZWxCYWNrZ3JvdW5kIjoiIzE4MTgxOCIsIm5vZGVCa2ciOiIjMWYyMDIwIiwibm9kZUJvcmRlciI6IiM4MUIxREIiLCJjbHVzdGVyQmtnIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiY2x1c3RlckJvcmRlciI6InJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNSkiLCJkZWZhdWx0TGlua0NvbG9yIjoibGlnaHRncmV5IiwidGl0bGVDb2xvciI6IiNGOUZGRkUiLCJlZGdlTGFiZWxCYWNrZ3JvdW5kIjoiaHNsKDAsIDAlLCAzNC40MTE3NjQ3MDU5JSkiLCJhY3RvckJvcmRlciI6IiM4MUIxREIiLCJhY3RvckJrZyI6IiMxZjIwMjAiLCJhY3RvclRleHRDb2xvciI6ImxpZ2h0Z3JleSIsImFjdG9yTGluZUNvbG9yIjoibGlnaHRncmV5Iiwic2lnbmFsQ29sb3IiOiJsaWdodGdyZXkiLCJzaWduYWxUZXh0Q29sb3IiOiJsaWdodGdyZXkiLCJsYWJlbEJveEJrZ0NvbG9yIjoiIzFmMjAyMCIsImxhYmVsQm94Qm9yZGVyQ29sb3IiOiIjODFCMURCIiwibGFiZWxUZXh0Q29sb3IiOiJsaWdodGdyZXkiLCJsb29wVGV4dENvbG9yIjoibGlnaHRncmV5Iiwibm90ZUJvcmRlckNvbG9yIjoicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KSIsIm5vdGVCa2dDb2xvciI6IiNmZmY1YWQiLCJub3RlVGV4dENvbG9yIjoiIzFmMjAyMCIsImFjdGl2YXRpb25Cb3JkZXJDb2xvciI6IiM4MUIxREIiLCJhY3RpdmF0aW9uQmtnQ29sb3IiOiJoc2woMTgwLCAxLjU4NzMwMTU4NzMlLCAyOC4zNTI5NDExNzY1JSkiLCJzZXF1ZW5jZU51bWJlckNvbG9yIjoiYmxhY2siLCJzZWN0aW9uQmtnQ29sb3IiOiJoc2woNTIuOTQxMTc2NDcwNiwgMjguODEzNTU5MzIyJSwgNTguNDMxMzcyNTQ5JSkiLCJhbHRTZWN0aW9uQmtnQ29sb3IiOiIjMzMzIiwic2VjdGlvbkJrZ0NvbG9yMiI6IiNFQUU4RDkiLCJ0YXNrQm9yZGVyQ29sb3IiOiIjZmZmZmZmIiwidGFza0JrZ0NvbG9yIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMzUuMzUyOTQxMTc2NSUpIiwidGFza1RleHRDb2xvciI6ImhzbCgyOC41NzE0Mjg1NzE0LCAxNy4zNTUzNzE5MDA4JSwgODYuMjc0NTA5ODAzOSUpIiwidGFza1RleHRMaWdodENvbG9yIjoibGlnaHRncmV5IiwidGFza1RleHRPdXRzaWRlQ29sb3IiOiJsaWdodGdyZXkiLCJ0YXNrVGV4dENsaWNrYWJsZUNvbG9yIjoiIzAwMzE2MyIsImFjdGl2ZVRhc2tCb3JkZXJDb2xvciI6IiNmZmZmZmYiLCJhY3RpdmVUYXNrQmtnQ29sb3IiOiIjODFCMURCIiwiZ3JpZENvbG9yIjoibGlnaHRncmV5IiwiZG9uZVRhc2tCa2dDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQm9yZGVyQ29sb3IiOiJncmV5IiwiY3JpdEJvcmRlckNvbG9yIjoiI0U4MzczNyIsImNyaXRCa2dDb2xvciI6IiNFODM3MzciLCJ0YXNrVGV4dERhcmtDb2xvciI6ImhzbCgyOC41NzE0Mjg1NzE0LCAxNy4zNTUzNzE5MDA4JSwgODYuMjc0NTA5ODAzOSUpIiwidG9kYXlMaW5lQ29sb3IiOiIjREI1NzU3IiwibGFiZWxDb2xvciI6IiNjY2MiLCJlcnJvckJrZ0NvbG9yIjoiI2E0NDE0MSIsImVycm9yVGV4dENvbG9yIjoiI2RkZCIsImFsdEJhY2tncm91bmQiOiJoc2woMCwgMCUsIDQwJSkiLCJmaWxsVHlwZTAiOiIjMWYyMDIwIiwiZmlsbFR5cGUxIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGUyIjoiaHNsKDI0NCwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGUzIjoiaHNsKDI0NCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU0IjoiaHNsKDExNiwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU1IjoiaHNsKDExNiwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU2IjoiaHNsKDMwOCwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU3IjoiaHNsKDMwOCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiY2xhc3NUZXh0IjoiI2UwZGZkZiJ9fX0)](mermaid1)

### HTTPS DynamoDB

Headers

* X-Amz-Target: Action
* Authorization: Credentials
* Data Type description
* x-amzn-RequestId: Generated by Amazon
* Data: All data from the Item
* Date: Timestamp

### DocumentClient

High level API for CRUD

### DynamoDB Local

Downloadable dynamodb for local development

```sh
aws dynamodb create-table \
--table-name Music \
--key-schema AttributeName=Artist,KeyType=HASH \
             AttributeName=SongTitle,KeyType=RANGE \
--attribute-definitions \
             AttributeName=Artist,AttributeType=S \
             AttributeName=SongTitle,AttributeType=S \
--provisioned-throughput \
             ReadCapacityUnits=5,WriteCapacityUnits=5
--endpoint-url http://localhost:8000

aws dynamodb describe-table --table-name Music --endpoint-url http://localhost:8000
# Definition of table
```

**Docker Image**

[REF](https://hub.docker.com/r/amazon/dynamodb-local/)
```sh
docker run -d -p 8000:8000 amazon/dynamodb-local
```

[mermaid1]: https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoic3RhdGVEaWFncmFtXG4gICAgWypdIC0tPiBBcHBcbiAgICBBcHAgLS0-IEFXU1NESzogQVBJIExldmVsIFJlcXVlc3RcbiAgICBBV1NTREsgLS0-IEFwcDogQVBJIExldmVsIFJlc3BvbnNlXG4gICAgQVdTU0RLIC0tPiBEREJMb3dMZXZlbDogTG93IExldmVsIFJlcXVlc3RcbiAgICBEREJMb3dMZXZlbCAtLT4gQVdTU0RLOiBMb3cgTGV2ZWwgUmVzcG9uc2VcbiAgICBEREJMb3dMZXZlbCAtLT4gRHluYW1vREI6IEhUVFBTIFJlcXVlc3RcbiAgICBEeW5hbW9EQiAtLT4gRERCTG93TGV2ZWw6IEhUVFBTIFJlc3BvbnNlXG4gICAgRHluYW1vREIiLCJtZXJtYWlkIjp7InRoZW1lIjoiZGFyayIsInRoZW1lVmFyaWFibGVzIjp7ImJhY2tncm91bmQiOiIjMzMzIiwicHJpbWFyeUNvbG9yIjoiIzFmMjAyMCIsInNlY29uZGFyeUNvbG9yIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwidGVydGlhcnlDb2xvciI6ImhzbCgyMCwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwicHJpbWFyeUJvcmRlckNvbG9yIjoiaHNsKDE4MCwgMCUsIDIuMzUyOTQxMTc2NSUpIiwic2Vjb25kYXJ5Qm9yZGVyQ29sb3IiOiJoc2woMTgwLCAwJSwgMTguMzUyOTQxMTc2NSUpIiwidGVydGlhcnlCb3JkZXJDb2xvciI6ImhzbCgyMCwgMCUsIDIuMzUyOTQxMTc2NSUpIiwicHJpbWFyeVRleHRDb2xvciI6IiNlMGRmZGYiLCJzZWNvbmRhcnlUZXh0Q29sb3IiOiJyZ2IoMTgzLjg0NzYxOTA0NzUsIDE4MS41NTIzODA5NTIzLCAxODEuNTUyMzgwOTUyMykiLCJ0ZXJ0aWFyeVRleHRDb2xvciI6InJnYigyMjIuOTk5OTk5OTk5OSwgMjIzLjY2NjY2NjY2NjYsIDIyMy45OTk5OTk5OTk5KSIsImxpbmVDb2xvciI6ImxpZ2h0Z3JleSIsInRleHRDb2xvciI6IiNjY2MiLCJtYWluQmtnIjoiIzFmMjAyMCIsInNlY29uZEJrZyI6ImhzbCgxODAsIDEuNTg3MzAxNTg3MyUsIDI4LjM1Mjk0MTE3NjUlKSIsIm1haW5Db250cmFzdENvbG9yIjoibGlnaHRncmV5IiwiZGFya1RleHRDb2xvciI6ImhzbCgyOC41NzE0Mjg1NzE0LCAxNy4zNTUzNzE5MDA4JSwgODYuMjc0NTA5ODAzOSUpIiwiYm9yZGVyMSI6IiM4MUIxREIiLCJib3JkZXIyIjoicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KSIsImFycm93aGVhZENvbG9yIjoibGlnaHRncmV5IiwiZm9udEZhbWlseSI6IlwidHJlYnVjaGV0IG1zXCIsIHZlcmRhbmEsIGFyaWFsIiwiZm9udFNpemUiOiIxNnB4IiwibGFiZWxCYWNrZ3JvdW5kIjoiIzE4MTgxOCIsIm5vZGVCa2ciOiIjMWYyMDIwIiwibm9kZUJvcmRlciI6IiM4MUIxREIiLCJjbHVzdGVyQmtnIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiY2x1c3RlckJvcmRlciI6InJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNSkiLCJkZWZhdWx0TGlua0NvbG9yIjoibGlnaHRncmV5IiwidGl0bGVDb2xvciI6IiNGOUZGRkUiLCJlZGdlTGFiZWxCYWNrZ3JvdW5kIjoiaHNsKDAsIDAlLCAzNC40MTE3NjQ3MDU5JSkiLCJhY3RvckJvcmRlciI6IiM4MUIxREIiLCJhY3RvckJrZyI6IiMxZjIwMjAiLCJhY3RvclRleHRDb2xvciI6ImxpZ2h0Z3JleSIsImFjdG9yTGluZUNvbG9yIjoibGlnaHRncmV5Iiwic2lnbmFsQ29sb3IiOiJsaWdodGdyZXkiLCJzaWduYWxUZXh0Q29sb3IiOiJsaWdodGdyZXkiLCJsYWJlbEJveEJrZ0NvbG9yIjoiIzFmMjAyMCIsImxhYmVsQm94Qm9yZGVyQ29sb3IiOiIjODFCMURCIiwibGFiZWxUZXh0Q29sb3IiOiJsaWdodGdyZXkiLCJsb29wVGV4dENvbG9yIjoibGlnaHRncmV5Iiwibm90ZUJvcmRlckNvbG9yIjoicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KSIsIm5vdGVCa2dDb2xvciI6IiNmZmY1YWQiLCJub3RlVGV4dENvbG9yIjoiIzFmMjAyMCIsImFjdGl2YXRpb25Cb3JkZXJDb2xvciI6IiM4MUIxREIiLCJhY3RpdmF0aW9uQmtnQ29sb3IiOiJoc2woMTgwLCAxLjU4NzMwMTU4NzMlLCAyOC4zNTI5NDExNzY1JSkiLCJzZXF1ZW5jZU51bWJlckNvbG9yIjoiYmxhY2siLCJzZWN0aW9uQmtnQ29sb3IiOiJoc2woNTIuOTQxMTc2NDcwNiwgMjguODEzNTU5MzIyJSwgNTguNDMxMzcyNTQ5JSkiLCJhbHRTZWN0aW9uQmtnQ29sb3IiOiIjMzMzIiwic2VjdGlvbkJrZ0NvbG9yMiI6IiNFQUU4RDkiLCJ0YXNrQm9yZGVyQ29sb3IiOiIjZmZmZmZmIiwidGFza0JrZ0NvbG9yIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMzUuMzUyOTQxMTc2NSUpIiwidGFza1RleHRDb2xvciI6ImhzbCgyOC41NzE0Mjg1NzE0LCAxNy4zNTUzNzE5MDA4JSwgODYuMjc0NTA5ODAzOSUpIiwidGFza1RleHRMaWdodENvbG9yIjoibGlnaHRncmV5IiwidGFza1RleHRPdXRzaWRlQ29sb3IiOiJsaWdodGdyZXkiLCJ0YXNrVGV4dENsaWNrYWJsZUNvbG9yIjoiIzAwMzE2MyIsImFjdGl2ZVRhc2tCb3JkZXJDb2xvciI6IiNmZmZmZmYiLCJhY3RpdmVUYXNrQmtnQ29sb3IiOiIjODFCMURCIiwiZ3JpZENvbG9yIjoibGlnaHRncmV5IiwiZG9uZVRhc2tCa2dDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQm9yZGVyQ29sb3IiOiJncmV5IiwiY3JpdEJvcmRlckNvbG9yIjoiI0U4MzczNyIsImNyaXRCa2dDb2xvciI6IiNFODM3MzciLCJ0YXNrVGV4dERhcmtDb2xvciI6ImhzbCgyOC41NzE0Mjg1NzE0LCAxNy4zNTUzNzE5MDA4JSwgODYuMjc0NTA5ODAzOSUpIiwidG9kYXlMaW5lQ29sb3IiOiIjREI1NzU3IiwibGFiZWxDb2xvciI6IiNjY2MiLCJlcnJvckJrZ0NvbG9yIjoiI2E0NDE0MSIsImVycm9yVGV4dENvbG9yIjoiI2RkZCIsImFsdEJhY2tncm91bmQiOiJoc2woMCwgMCUsIDQwJSkiLCJmaWxsVHlwZTAiOiIjMWYyMDIwIiwiZmlsbFR5cGUxIjoiaHNsKDE4MCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGUyIjoiaHNsKDI0NCwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGUzIjoiaHNsKDI0NCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU0IjoiaHNsKDExNiwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU1IjoiaHNsKDExNiwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU2IjoiaHNsKDMwOCwgMS41ODczMDE1ODczJSwgMTIuMzUyOTQxMTc2NSUpIiwiZmlsbFR5cGU3IjoiaHNsKDMwOCwgMS41ODczMDE1ODczJSwgMjguMzUyOTQxMTc2NSUpIiwiY2xhc3NUZXh0IjoiI2UwZGZkZiJ9fX0